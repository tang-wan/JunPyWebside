<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../../../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Carbon Chain (Part 2) &mdash; JunPy Webside 0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../../../../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../../../../../../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../../../../../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
      <link rel="stylesheet" type="text/css" href="../../../../../../_static/custom.css" />

  
  <!--[if lt IE 9]>
    <script src="../../../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../../../../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../../../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../../../../../_static/documentation_options.js?v=2709fde1"></script>
        <script src="../../../../../../_static/doctools.js?v=9a2dae69"></script>
        <script src="../../../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../../../../index.html" class="icon icon-home">
            JunPy Webside
          </a>
              <div class="version">
                0.1.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Guildlines:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../Guildline/1_Installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../Guildline/2_Tutorial.html">Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../Guildline/3_Example.html">Example</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../Guildline/4_InputReference.html">Input reference</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Appendix:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../Appendix/5_Theorem.html">Theorem</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../Appendix/6_ContactUs.html">Contact us</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../Appendix/7_Forum.html">Forum</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../../../index.html">JunPy Webside</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Carbon Chain (Part 2)</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../../../../_sources/_build/jupyter_execute/_build/jupyter_execute/Guildline/notebooks/nad_cc2.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="carbon-chain-part-2">
<h1>Carbon Chain (Part 2)<a class="headerlink" href="#carbon-chain-part-2" title="Link to this heading"></a></h1>
<p>This example demonstrates the calculations of charge current, spin torque, and interfacial spin current for a two-probe carbon chain. Unlike the first example, this device is subject to an electrical bias of 0.1 V.</p>
<section id="import-necessary-libraries">
<h2>Import Necessary Libraries<a class="headerlink" href="#import-necessary-libraries" title="Link to this heading"></a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">junpy</span> <span class="k">as</span> <span class="nn">jp</span>
<span class="kn">from</span> <span class="nn">junpy.factory</span> <span class="kn">import</span> <span class="n">nanodcal</span>
<span class="kn">from</span> <span class="nn">junpy.experiment.extend_center_2</span> <span class="kn">import</span> <span class="n">extend_center</span>
<span class="o">%</span><span class="k">config</span> InlineBackend.figure_formats = [&#39;svg&#39;]
<span class="o">%</span><span class="k">config</span> InlineBackend.rc = {&#39;font.size&#39;: 12}
</pre></div>
</div>
</div>
</div>
</section>
<section id="load-device">
<h2>Load Device<a class="headerlink" href="#load-device" title="Link to this heading"></a></h2>
<p>In order to observe the variation of the spin torque and interfacial spin current beyond the central region, we can include the electrode atoms into the central region using the <code class="docutils literal notranslate"><span class="pre">extend_center</span></code> function. <code class="docutils literal notranslate"><span class="pre">repeatL</span></code> and <code class="docutils literal notranslate"><span class="pre">repeatR</span></code> specify the repetition multiples of the left and right electrodes, respectively.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">filename</span> <span class="o">=</span> <span class="p">(</span>
    <span class="s1">&#39;jpdataset/nanodcal/twoprobe_carbon_chain/&#39;</span>
    <span class="s1">&#39;LDA_NC_dC-3.0-ang/sys_6C-vac5ang-6C_zx0-zx90/v0.10/NanodcalStructObject.mat&#39;</span><span class="p">)</span>
<span class="n">device</span> <span class="o">=</span> <span class="n">nanodcal</span><span class="o">.</span><span class="n">load_nanodcal_device</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
<span class="n">device_ext</span> <span class="o">=</span> <span class="n">extend_center</span><span class="p">(</span><span class="n">device</span><span class="p">,</span> <span class="n">repeatL</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">repeatR</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="calculate-charge-current">
<h2>Calculate Charge Current<a class="headerlink" href="#calculate-charge-current" title="Link to this heading"></a></h2>
<p>We first calculate the charge current using the Landau’s formula. <code class="docutils literal notranslate"><span class="pre">jp.BiasWindow(interval=0.005)</span></code> specifies that the energy integral is in the bias window and the interval is <code class="docutils literal notranslate"><span class="pre">0.005</span></code>.</p>
<div class="cell tag_hide-output docutils container">
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">calcr</span> <span class="o">=</span> <span class="n">jp</span><span class="o">.</span><span class="n">Current</span><span class="p">(</span>
    <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">,</span>
    <span class="n">energies</span><span class="o">=</span><span class="n">jp</span><span class="o">.</span><span class="n">BiasWindow</span><span class="p">(</span><span class="n">interval</span><span class="o">=</span><span class="mf">0.005</span><span class="p">),</span>
    <span class="n">etaSigma</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">,</span>
    <span class="n">etaGF</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">jp</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">calcr</span><span class="p">,</span> <span class="n">savefile</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<details class="hide below-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell output</span>
<span class="expanded">Hide code cell output</span>
</summary>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>JunPy version---------------------------: 0.15.0.post29+ga5b3260
Parallelization information
    BLAS Vendor-----------------------------: MKL
    Total number of MPI processes-----------: 1
    OMP_NUM_THREADS-------------------------: 1
    MKL_NUM_THREADS-------------------------: unset
    OPENBLAS_NUM_THREADS--------------------: unset
Calculating current... (2024-08-15 20:30:08)
    Device information
        bias (mu2-mu1)--------------------------: 0.10000001031619467
        central.numberOfSites-------------------: 12
        central.spinType------------------------: SpinType.GeneralSpin
        lead1.numberOfSites---------------------: 3
        lead1.spinType--------------------------: SpinType.GeneralSpin
        lead1.direction-------------------------: -3
        lead1.temperature-----------------------: 0.0
        lead1.chemicalPotential-----------------: -0.0
        lead2.numberOfSites---------------------: 3
        lead2.spinType--------------------------: SpinType.GeneralSpin
        lead2.direction-------------------------: -3
        lead2.temperature-----------------------: 0.0
        lead2.chemicalPotential-----------------: 0.10000001031619467
    Energy sampling
        samplingName----------------------------: CustomSampling
        range-----------------------------------: [0.0000e+00, 1.0000e-01]
        number----------------------------------: 21
    K-space sampling
        samplingName----------------------------: GammaKspaceSampling
        numReducedKpoints-----------------------: 1
    Runtime message
        Integrate over energy and k-space...
            Start MPI execution...
            --&gt;   9.5% finished (Elapsed time: 0:00:00.228234)
            --&gt;  14.3% finished (Elapsed time: 0:00:00.109371)
            --&gt;  19.0% finished (Elapsed time: 0:00:00.106565)
            --&gt;  23.8% finished (Elapsed time: 0:00:00.109306)
            --&gt;  28.6% finished (Elapsed time: 0:00:00.106735)
            --&gt;  33.3% finished (Elapsed time: 0:00:00.109937)
            --&gt;  38.1% finished (Elapsed time: 0:00:00.111408)
            --&gt;  42.9% finished (Elapsed time: 0:00:00.114061)
            --&gt;  47.6% finished (Elapsed time: 0:00:00.137588)
            --&gt;  52.4% finished (Elapsed time: 0:00:00.116131)
            --&gt;  57.1% finished (Elapsed time: 0:00:00.120204)
            --&gt;  61.9% finished (Elapsed time: 0:00:00.121313)
            --&gt;  66.7% finished (Elapsed time: 0:00:00.116271)
            --&gt;  71.4% finished (Elapsed time: 0:00:00.117937)
            --&gt;  76.2% finished (Elapsed time: 0:00:00.126648)
            --&gt;  81.0% finished (Elapsed time: 0:00:00.111192)
            --&gt;  85.7% finished (Elapsed time: 0:00:00.111798)
            --&gt;  90.5% finished (Elapsed time: 0:00:00.119536)
            --&gt;  95.2% finished (Elapsed time: 0:00:00.117534)
            --&gt; 100.0% finished (Elapsed time: 0:00:00.114353)
            Wait for other processes...
            --&gt; finished (Elapsed time: 0:00:00.000057)
            Gather results from other processes...
            --&gt; finished (Elapsed time: 0:00:00.000071)
    Transmission report
            Energy_eV       T_up-up       T_dn-dn    T_Re-up-dn    T_Im-up-dn
         0.000000e+00  5.125604e-03  5.155845e-03  5.125587e-03  5.870280e-07
         5.000000e-03  5.168260e-03  5.199103e-03  5.168243e-03  2.792357e-07
         1.000000e-02  5.177481e-03  5.208924e-03  5.177463e-03 -4.197218e-08
         1.500000e-02  5.153973e-03  5.186013e-03  5.153955e-03 -3.766792e-07
         2.000000e-02  5.103020e-03  5.135655e-03  5.103002e-03 -7.248664e-07
         2.500000e-02  5.033139e-03  5.066364e-03  5.033122e-03 -1.086472e-06
         3.000000e-02  4.953992e-03  4.987802e-03  4.953974e-03 -1.461457e-06
         3.500000e-02  4.874493e-03  4.908883e-03  4.874476e-03 -1.849847e-06
         4.000000e-02  4.801748e-03  4.836712e-03  4.801731e-03 -2.251742e-06
         4.500000e-02  4.740657e-03  4.776187e-03  4.740640e-03 -2.667317e-06
         5.000000e-02  4.694354e-03  4.730444e-03  4.694337e-03 -3.096793e-06
         5.500000e-02  4.664560e-03  4.701202e-03  4.664543e-03 -3.540424e-06
         6.000000e-02  4.652075e-03  4.689260e-03  4.652058e-03 -3.998476e-06
         6.500000e-02  4.657063e-03  4.694781e-03  4.657046e-03 -4.471221e-06
         7.000000e-02  4.679121e-03  4.717362e-03  4.679104e-03 -4.958921e-06
         7.500000e-02  4.717060e-03  4.755813e-03  4.717043e-03 -5.461822e-06
         8.000000e-02  4.768320e-03  4.807572e-03  4.768303e-03 -5.980142e-06
         8.500000e-02  4.827857e-03  4.867596e-03  4.827840e-03 -6.514042e-06
         9.000000e-02  4.886376e-03  4.926586e-03  4.886358e-03 -7.063593e-06
         9.500000e-02  4.927877e-03  4.968544e-03  4.927859e-03 -7.628725e-06
         1.000000e-01  4.927375e-03  4.968483e-03  4.927357e-03 -8.209163e-06
    Current report
              Bias[V]      I_tot[A]       I_up[A]       I_dn[A]        I_s[A]       I_sp[%]
         1.000000e-01  3.791430e-08  1.888751e-08  1.902679e-08 -1.392818e-10 -3.673596e-01
Calculation of current finished (2024-08-15 20:30:11)
Elapsed time----------------------------: 0:00:02.463467
</pre></div>
</div>
</div>
</details>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">[calcr].current</span></code> function returns the calculated value.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">current</span> <span class="o">=</span> <span class="n">calcr</span><span class="o">.</span><span class="n">current</span><span class="p">(</span><span class="n">spin</span><span class="o">=</span><span class="s2">&quot;sum&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The charge current is </span><span class="si">{</span><span class="n">current</span><span class="si">}</span><span class="s1"> ampere.&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The charge current is [3.79142962e-08] ampere.
</pre></div>
</div>
</div>
</div>
</section>
<section id="calculate-spin-torque">
<h2>Calculate Spin Torque<a class="headerlink" href="#calculate-spin-torque" title="Link to this heading"></a></h2>
<p>We use the <code class="docutils literal notranslate"><span class="pre">jp.SpinTorque</span></code> class to build a calculation for spin torque. <code class="docutils literal notranslate"><span class="pre">nonequilibriumEnergies</span></code> specifies the energy sampling for integrating the real-axis energy for the Green’s function. <code class="docutils literal notranslate"><span class="pre">equilibriumEnergies</span></code> specifies the energy sampling for integrating the complex contour energy for the Green’s function. <code class="docutils literal notranslate"><span class="pre">circlePoints</span></code> is the number of points, and <code class="docutils literal notranslate"><span class="pre">lowestEnergy</span></code> is the starting point for the lowest energy. <code class="docutils literal notranslate"><span class="pre">spinAccumulationDetail</span></code> specifies whether to compute the spin accumulation or not.</p>
<div class="cell tag_hide-output docutils container">
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">calcr_st</span> <span class="o">=</span> <span class="n">jp</span><span class="o">.</span><span class="n">SpinTorque</span><span class="p">(</span>
    <span class="n">device</span><span class="o">=</span><span class="n">device_ext</span><span class="p">,</span>
    <span class="n">nonequilibriumEnergies</span><span class="o">=</span><span class="n">jp</span><span class="o">.</span><span class="n">BiasWindow</span><span class="p">(</span><span class="n">interval</span><span class="o">=</span><span class="mf">0.005</span><span class="p">),</span>
    <span class="n">equilibriumEnergies</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
        <span class="n">circlePoints</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span>
        <span class="n">lowestEnergy</span><span class="o">=-</span><span class="mi">30</span><span class="p">),</span>
    <span class="n">spinAccumulationDetail</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">jp</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">calcr_st</span><span class="p">,</span> <span class="n">savefile</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<details class="hide below-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell output</span>
<span class="expanded">Hide code cell output</span>
</summary>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>JunPy version---------------------------: 0.15.0.post29+ga5b3260
Parallelization information
    BLAS Vendor-----------------------------: MKL
    Total number of MPI processes-----------: 1
    OMP_NUM_THREADS-------------------------: 1
    MKL_NUM_THREADS-------------------------: unset
    OPENBLAS_NUM_THREADS--------------------: unset
Calculating spin torque... (2024-08-15 20:30:17)
    Device information
        bias (mu2-mu1)--------------------------: 0.10000001031619467
        central.numberOfSites-------------------: 30
        central.spinType------------------------: SpinType.GeneralSpin
        lead1.numberOfSites---------------------: 3
        lead1.spinType--------------------------: SpinType.GeneralSpin
        lead1.direction-------------------------: -3
        lead1.temperature-----------------------: 0.0
        lead1.chemicalPotential-----------------: -0.0
        lead2.numberOfSites---------------------: 3
        lead2.spinType--------------------------: SpinType.GeneralSpin
        lead2.direction-------------------------: 3
        lead2.temperature-----------------------: 0.0
        lead2.chemicalPotential-----------------: 0.10000001031619467
    Energy sampling (equilibrium)
        samplingName----------------------------: SemiCircleContourEnergySampling
        range-----------------------------------: [-3.0000e+01+7.3317e-02j, 4.9821e-02+7.3317e-02j]
        number----------------------------------: 30
        temperature-----------------------------: 0.0
        chemicalPotential-----------------------: 0.050000005158097334
        circlePoints----------------------------: 30
        lowestEnergy----------------------------: -30
    Energy sampling (non-equilibrium)
        samplingName----------------------------: CustomSampling
        range-----------------------------------: [0.0000e+00, 1.0000e-01]
        number----------------------------------: 21
    K-space sampling
        samplingName----------------------------: GammaKspaceSampling
        numReducedKpoints-----------------------: 1
    Runtime message
        Integrate over energy and k-space...
            Start MPI execution...
            --&gt;   6.7% finished (Elapsed time: 0:00:03.509986)
            --&gt;  13.3% finished (Elapsed time: 0:00:03.485396)
            --&gt;  20.0% finished (Elapsed time: 0:00:03.381314)
            --&gt;  26.7% finished (Elapsed time: 0:00:03.340263)
            --&gt;  33.3% finished (Elapsed time: 0:00:03.272934)
            --&gt;  40.0% finished (Elapsed time: 0:00:03.311562)
            --&gt;  46.7% finished (Elapsed time: 0:00:03.324781)
            --&gt;  53.3% finished (Elapsed time: 0:00:03.312329)
            --&gt;  60.0% finished (Elapsed time: 0:00:03.297522)
            --&gt;  66.7% finished (Elapsed time: 0:00:03.231385)
            --&gt;  70.0% finished (Elapsed time: 0:00:01.634883)
            --&gt;  73.3% finished (Elapsed time: 0:00:01.609632)
            --&gt;  76.7% finished (Elapsed time: 0:00:01.619557)
            --&gt;  80.0% finished (Elapsed time: 0:00:01.621894)
            --&gt;  83.3% finished (Elapsed time: 0:00:01.684925)
            --&gt;  86.7% finished (Elapsed time: 0:00:01.621701)
            --&gt;  90.0% finished (Elapsed time: 0:00:01.623025)
            --&gt;  93.3% finished (Elapsed time: 0:00:01.670311)
            --&gt;  96.7% finished (Elapsed time: 0:00:01.610550)
            --&gt; 100.0% finished (Elapsed time: 0:00:01.606518)
            Wait for other processes...
            --&gt; finished (Elapsed time: 0:00:00.000006)
            Gather results from other processes...
            --&gt; finished (Elapsed time: 0:00:00.000104)
        Integrate over energy and k-space...
            Start MPI execution...
            --&gt;   9.5% finished (Elapsed time: 0:00:03.526256)
            --&gt;  14.3% finished (Elapsed time: 0:00:01.806523)
            --&gt;  19.0% finished (Elapsed time: 0:00:01.749344)
            --&gt;  23.8% finished (Elapsed time: 0:00:01.746309)
            --&gt;  28.6% finished (Elapsed time: 0:00:01.757293)
            --&gt;  33.3% finished (Elapsed time: 0:00:01.760958)
            --&gt;  38.1% finished (Elapsed time: 0:00:01.754006)
            --&gt;  42.9% finished (Elapsed time: 0:00:01.828860)
            --&gt;  47.6% finished (Elapsed time: 0:00:01.799265)
            --&gt;  52.4% finished (Elapsed time: 0:00:01.826866)
            --&gt;  57.1% finished (Elapsed time: 0:00:01.796251)
            --&gt;  61.9% finished (Elapsed time: 0:00:01.931762)
            --&gt;  66.7% finished (Elapsed time: 0:00:01.980609)
            --&gt;  71.4% finished (Elapsed time: 0:00:01.833493)
            --&gt;  76.2% finished (Elapsed time: 0:00:02.077866)
            --&gt;  81.0% finished (Elapsed time: 0:00:01.868748)
            --&gt;  85.7% finished (Elapsed time: 0:00:01.795185)
            --&gt;  90.5% finished (Elapsed time: 0:00:01.882095)
            --&gt;  95.2% finished (Elapsed time: 0:00:01.828351)
            --&gt; 100.0% finished (Elapsed time: 0:00:01.782389)
            Wait for other processes...
            --&gt; finished (Elapsed time: 0:00:00.000021)
            Gather results from other processes...
            --&gt; finished (Elapsed time: 0:00:00.000098)
    Report of the spin accumulation (Hamiltonian = H)
                 Site         Ax_eV         Ay_eV         Az_eV
         0.000000e+00  2.391885e-10 -7.026460e-10  1.629750e-02
         1.000000e+00 -2.836272e-09 -2.179475e-09 -1.671807e-02
         2.000000e+00  4.118441e-09  9.829391e-09  4.697895e-04
         3.000000e+00  1.159065e-08  6.948219e-09  2.901698e-05
         4.000000e+00 -3.516658e-08 -7.322370e-08 -1.246392e-06
         5.000000e+00 -3.264152e-08  1.540051e-08 -1.772569e-07
         6.000000e+00  2.525382e-07  5.097357e-07  4.042458e-08
         7.000000e+00 -9.355308e-08 -6.991133e-07  1.133889e-09
         8.000000e+00 -1.694422e-06 -3.231379e-06 -1.555806e-09
         9.000000e+00  2.215984e-06  6.009934e-06  3.682049e-10
         1.000000e+01  5.445955e-06  1.254568e-05 -9.172095e-11
         1.100000e+01 -8.368109e-06 -2.281097e-05 -2.218483e-10
         1.200000e+01 -2.192596e-05 -5.769606e-05 -1.193909e-09
         1.300000e+01  3.141844e-05  7.138241e-05 -4.728251e-09
         1.400000e+01  6.940915e-05  1.611806e-04 -2.494360e-07
         1.500000e+01  2.445917e-07 -1.560270e-04 -6.818500e-05
         1.600000e+01  6.256708e-09 -7.588276e-05 -3.145995e-05
         1.700000e+01  1.165871e-09  5.219711e-05  1.951402e-05
         1.800000e+01  3.661119e-10  2.726874e-05  9.048806e-06
         1.900000e+01  1.037239e-10 -1.131641e-05 -4.704706e-06
         2.000000e+01 -7.983134e-10 -6.642211e-06 -2.171086e-06
         2.100000e+01  2.470659e-09  2.656863e-06  1.306189e-06
         2.200000e+01  3.708007e-09  1.125140e-06  2.496813e-07
         2.300000e+01 -3.855253e-08 -5.336990e-07 -2.256748e-07
         2.400000e+01  1.020493e-07 -6.952084e-08 -2.963345e-09
         2.500000e+01 -1.795353e-06  8.784957e-08  3.642886e-08
         2.600000e+01  3.277303e-05 -1.797359e-10 -3.976666e-09
         2.700000e+01  4.139673e-04 -1.383013e-08 -5.682770e-09
         2.800000e+01 -1.800594e-02  1.570455e-09  1.319261e-09
         2.900000e+01  1.748407e-02  1.468057e-09  4.787378e-10
    Report of the spin torque (Hamiltonian = Hxc)
                 Site         Tx_eV         Ty_eV         Tz_eV
         0.000000e+00  3.269584e-10  1.223634e-09 -1.324897e-55
         1.000000e+00  2.785171e-09  2.166280e-09 -1.257245e-56
         2.000000e+00 -4.123942e-09 -9.813811e-09  5.993176e-55
         3.000000e+00 -1.159091e-08 -6.942518e-09 -7.645471e-56
         4.000000e+00  3.516636e-08  7.322534e-08 -4.216161e-54
         5.000000e+00  3.264148e-08 -1.539991e-08  3.151663e-54
         6.000000e+00 -2.525382e-07 -5.097355e-07  3.949711e-53
         7.000000e+00  9.355309e-08  6.991135e-07 -6.324194e-52
         8.000000e+00  1.694423e-06  3.231379e-06 -9.014559e-13
         9.000000e+00 -2.215984e-06 -6.009935e-06  1.441766e-11
         1.000000e+01 -5.445954e-06 -1.254568e-05  2.673385e-11
         1.100000e+01  8.368109e-06  2.281097e-05  2.245092e-10
         1.200000e+01  2.192596e-05  5.769606e-05  1.195948e-09
         1.300000e+01 -3.141844e-05 -7.138241e-05  4.727459e-09
         1.400000e+01 -6.940915e-05 -1.611806e-04  2.494362e-07
         1.500000e+01 -2.445916e-07  1.560270e-04  6.818500e-05
         1.600000e+01 -6.255845e-09  7.588276e-05  3.145995e-05
         1.700000e+01 -1.175754e-09 -5.219711e-05 -1.951402e-05
         1.800000e+01 -3.346235e-10 -2.726874e-05 -9.048806e-06
         1.900000e+01 -3.892913e-11  1.131641e-05  4.704706e-06
         2.000000e+01 -1.767191e-11  6.642212e-06  2.171086e-06
         2.100000e+01  9.832168e-13 -2.656864e-06 -1.306189e-06
         2.200000e+01 -1.226281e-19 -1.125140e-06 -2.496813e-07
         2.300000e+01  1.219638e-19  5.336987e-07  2.256747e-07
         2.400000e+01  1.818635e-21  6.952008e-08  2.963127e-09
         2.500000e+01 -1.892528e-20 -8.785165e-08 -3.642946e-08
         2.600000e+01  2.226064e-21  1.724682e-10  3.974142e-09
         2.700000e+01  2.499830e-21  1.380589e-08  5.675230e-09
         2.800000e+01 -7.099308e-22 -1.569675e-09 -1.304434e-09
         2.900000e+01 -4.567913e-22 -2.116465e-09 -8.689176e-10
    Report of the spin torque (Hamiltonian = Hso)
                 Site         Tx_eV         Ty_eV         Tz_eV
         0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00
         1.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00
         2.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00
         3.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00
         4.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00
         5.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00
         6.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00
         7.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00
         8.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00
         9.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00
         1.000000e+01  0.000000e+00  0.000000e+00  0.000000e+00
         1.100000e+01  0.000000e+00  0.000000e+00  0.000000e+00
         1.200000e+01  0.000000e+00  0.000000e+00  0.000000e+00
         1.300000e+01  0.000000e+00  0.000000e+00  0.000000e+00
         1.400000e+01  0.000000e+00  0.000000e+00  0.000000e+00
         1.500000e+01  0.000000e+00  0.000000e+00  0.000000e+00
         1.600000e+01  0.000000e+00  0.000000e+00  0.000000e+00
         1.700000e+01  0.000000e+00  0.000000e+00  0.000000e+00
         1.800000e+01  0.000000e+00  0.000000e+00  0.000000e+00
         1.900000e+01  0.000000e+00  0.000000e+00  0.000000e+00
         2.000000e+01  0.000000e+00  0.000000e+00  0.000000e+00
         2.100000e+01  0.000000e+00  0.000000e+00  0.000000e+00
         2.200000e+01  0.000000e+00  0.000000e+00  0.000000e+00
         2.300000e+01  0.000000e+00  0.000000e+00  0.000000e+00
         2.400000e+01  0.000000e+00  0.000000e+00  0.000000e+00
         2.500000e+01  0.000000e+00  0.000000e+00  0.000000e+00
         2.600000e+01  0.000000e+00  0.000000e+00  0.000000e+00
         2.700000e+01  0.000000e+00  0.000000e+00  0.000000e+00
         2.800000e+01  0.000000e+00  0.000000e+00  0.000000e+00
         2.900000e+01  0.000000e+00  0.000000e+00  0.000000e+00
Calculation of spin torque finished (2024-08-15 20:31:46)
Elapsed time----------------------------: 0:01:28.597522
</pre></div>
</div>
</div>
</details>
</div>
<p>In this example, we have 30 atoms in the extended central region. We create an array <code class="docutils literal notranslate"><span class="pre">sites</span></code> to label them:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sites</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">[calcr].spin_torque</span></code> function returns the computed spin torque values. The <code class="docutils literal notranslate"><span class="pre">hamiltonian</span></code> parameter specifies the Hamiltonian used for computing the spin torque. Possible values are <code class="docutils literal notranslate"><span class="pre">'full'</span></code> (default), <code class="docutils literal notranslate"><span class="pre">'H0'</span></code>, <code class="docutils literal notranslate"><span class="pre">'Hxc'</span></code>, and <code class="docutils literal notranslate"><span class="pre">'Hso'</span></code>. Note that <code class="docutils literal notranslate"><span class="pre">'Hxc'</span></code> and <code class="docutils literal notranslate"><span class="pre">'Hso'</span></code> correspond to the exchange spin torque ($T^\mathrm{XC}$) and spin-orbit torque ($T^\mathrm{SO}$), respectively.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># shape: (#kpoints, #energies, #sites, #spin)</span>
<span class="n">st</span> <span class="o">=</span> <span class="n">calcr_st</span><span class="o">.</span><span class="n">spin_torque</span><span class="p">(</span><span class="n">hamiltonian</span><span class="o">=</span><span class="s1">&#39;Hxc&#39;</span><span class="p">)</span>
<span class="c1"># shape: (#sites, #spin)</span>
<span class="n">st</span> <span class="o">=</span> <span class="n">st</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>We exclude the boundary atoms using <code class="docutils literal notranslate"><span class="pre">[3:-3]</span></code> to remove the uncalculated boundary results:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sites</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="o">-</span><span class="mi">3</span><span class="p">],</span> <span class="n">st</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mf">1e3</span><span class="p">,</span> <span class="s1">&#39;.-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Txc_x&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sites</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="o">-</span><span class="mi">3</span><span class="p">],</span> <span class="n">st</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mf">1e3</span><span class="p">,</span> <span class="s1">&#39;.-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Txc_y&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sites</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="o">-</span><span class="mi">3</span><span class="p">],</span> <span class="n">st</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="mf">1e3</span><span class="p">,</span> <span class="s1">&#39;.-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Txc_z&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Site (#)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Spin torque (meV)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../../../../_images/02eb183f79e15649c82284c324de9686e004abeb5981b60ccb6f5877a534f565.svg" src="../../../../../../_images/02eb183f79e15649c82284c324de9686e004abeb5981b60ccb6f5877a534f565.svg" />
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">[calcr].spin_accumulation</span></code> function is used to retrieve the computed spin accumulation values ($\Phi$).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># shape: (#kpoints, #energies, #sites, #spin)</span>
<span class="n">sa</span> <span class="o">=</span> <span class="n">calcr_st</span><span class="o">.</span><span class="n">spin_accumulation</span><span class="p">()</span>
<span class="c1"># shape: (#sites, #spin)</span>
<span class="n">sa</span> <span class="o">=</span> <span class="n">sa</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sites</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="o">-</span><span class="mi">3</span><span class="p">],</span> <span class="n">sa</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mf">1e3</span><span class="p">,</span> <span class="s1">&#39;.-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$\Phi$x&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sites</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="o">-</span><span class="mi">3</span><span class="p">],</span> <span class="n">sa</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mf">1e3</span><span class="p">,</span> <span class="s1">&#39;.-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$\Phi$y&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sites</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="o">-</span><span class="mi">3</span><span class="p">],</span> <span class="n">sa</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="mf">1e3</span><span class="p">,</span> <span class="s1">&#39;.-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$\Phi$z&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Site (#)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Spin accumulation (meV)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../../../../_images/37a63582ab1610ee2f848561c959c64110083a378dfdb1483fa462c5814bfefd.svg" src="../../../../../../_images/37a63582ab1610ee2f848561c959c64110083a378dfdb1483fa462c5814bfefd.svg" />
</div>
</div>
</section>
<section id="calculate-interfacial-spin-current">
<h2>Calculate Interfacial Spin Current<a class="headerlink" href="#calculate-interfacial-spin-current" title="Link to this heading"></a></h2>
<p>For comparison, we also compute the interfacial spin current using the <code class="docutils literal notranslate"><span class="pre">jp.SpinCurrent</span></code> class.</p>
<div class="cell tag_hide-output docutils container">
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">calcr_sc</span> <span class="o">=</span> <span class="n">jp</span><span class="o">.</span><span class="n">SpinCurrent</span><span class="p">(</span>
    <span class="n">device</span><span class="o">=</span><span class="n">device_ext</span><span class="p">,</span>
    <span class="n">nonequilibriumEnergies</span><span class="o">=</span><span class="n">jp</span><span class="o">.</span><span class="n">BiasWindow</span><span class="p">(</span><span class="n">interval</span><span class="o">=</span><span class="mf">0.005</span><span class="p">),</span>
    <span class="n">equilibriumEnergies</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
        <span class="n">circlePoints</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span>
        <span class="n">lowestEnergy</span><span class="o">=-</span><span class="mi">30</span><span class="p">))</span>
<span class="n">jp</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">calcr_sc</span><span class="p">,</span> <span class="n">savefile</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<details class="hide below-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell output</span>
<span class="expanded">Hide code cell output</span>
</summary>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>JunPy version---------------------------: 0.15.0.post29+ga5b3260
Parallelization information
    BLAS Vendor-----------------------------: MKL
    Total number of MPI processes-----------: 1
    OMP_NUM_THREADS-------------------------: 1
    MKL_NUM_THREADS-------------------------: unset
    OPENBLAS_NUM_THREADS--------------------: unset
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Calculating spin current... (2024-08-15 20:38:09)
    Device information
        bias (mu2-mu1)--------------------------: 0.10000001031619467
        central.numberOfSites-------------------: 30
        central.spinType------------------------: SpinType.GeneralSpin
        lead1.numberOfSites---------------------: 3
        lead1.spinType--------------------------: SpinType.GeneralSpin
        lead1.direction-------------------------: -3
        lead1.temperature-----------------------: 0.0
        lead1.chemicalPotential-----------------: -0.0
        lead2.numberOfSites---------------------: 3
        lead2.spinType--------------------------: SpinType.GeneralSpin
        lead2.direction-------------------------: 3
        lead2.temperature-----------------------: 0.0
        lead2.chemicalPotential-----------------: 0.10000001031619467
    Energy sampling (equilibrium)
        samplingName----------------------------: SemiCircleContourEnergySampling
        range-----------------------------------: [-3.0000e+01+7.3317e-02j, 4.9821e-02+7.3317e-02j]
        number----------------------------------: 30
        temperature-----------------------------: 0.0
        chemicalPotential-----------------------: 0.050000005158097334
        circlePoints----------------------------: 30
        lowestEnergy----------------------------: -30
    Energy sampling (non-equilibrium)
        samplingName----------------------------: CustomSampling
        range-----------------------------------: [0.0000e+00, 1.0000e-01]
        number----------------------------------: 21
    K-space sampling
        samplingName----------------------------: GammaKspaceSampling
        numReducedKpoints-----------------------: 1
    Runtime message
        Integrate over energy and k-space...
            Start MPI execution...
            --&gt;   6.7% finished (Elapsed time: 0:00:01.713761)
            --&gt;  13.3% finished (Elapsed time: 0:00:01.681413)
            --&gt;  20.0% finished (Elapsed time: 0:00:01.666176)
            --&gt;  26.7% finished (Elapsed time: 0:00:01.703826)
            --&gt;  33.3% finished (Elapsed time: 0:00:01.640098)
            --&gt;  40.0% finished (Elapsed time: 0:00:01.701506)
            --&gt;  46.7% finished (Elapsed time: 0:00:01.668116)
            --&gt;  53.3% finished (Elapsed time: 0:00:01.661861)
            --&gt;  60.0% finished (Elapsed time: 0:00:01.669353)
            --&gt;  66.7% finished (Elapsed time: 0:00:01.700550)
            --&gt;  70.0% finished (Elapsed time: 0:00:00.787154)
            --&gt;  73.3% finished (Elapsed time: 0:00:00.786871)
            --&gt;  76.7% finished (Elapsed time: 0:00:00.775879)
            --&gt;  80.0% finished (Elapsed time: 0:00:00.811188)
            --&gt;  83.3% finished (Elapsed time: 0:00:00.822507)
            --&gt;  86.7% finished (Elapsed time: 0:00:00.823056)
            --&gt;  90.0% finished (Elapsed time: 0:00:00.829303)
            --&gt;  93.3% finished (Elapsed time: 0:00:00.829970)
            --&gt;  96.7% finished (Elapsed time: 0:00:00.836421)
            --&gt; 100.0% finished (Elapsed time: 0:00:00.872034)
            Wait for other processes...
            --&gt; finished (Elapsed time: 0:00:00.000024)
            Gather results from other processes...
            --&gt; finished (Elapsed time: 0:00:00.007837)
        Integrate over energy and k-space...
            Start MPI execution...
            --&gt;   9.5% finished (Elapsed time: 0:00:01.974358)
            --&gt;  14.3% finished (Elapsed time: 0:00:00.994233)
            --&gt;  19.0% finished (Elapsed time: 0:00:00.979632)
            --&gt;  23.8% finished (Elapsed time: 0:00:00.976806)
            --&gt;  28.6% finished (Elapsed time: 0:00:00.980045)
            --&gt;  33.3% finished (Elapsed time: 0:00:00.990213)
            --&gt;  38.1% finished (Elapsed time: 0:00:00.980436)
            --&gt;  42.9% finished (Elapsed time: 0:00:00.976911)
            --&gt;  47.6% finished (Elapsed time: 0:00:00.979780)
            --&gt;  52.4% finished (Elapsed time: 0:00:00.979087)
            --&gt;  57.1% finished (Elapsed time: 0:00:00.976780)
            --&gt;  61.9% finished (Elapsed time: 0:00:01.039201)
            --&gt;  66.7% finished (Elapsed time: 0:00:00.977404)
            --&gt;  71.4% finished (Elapsed time: 0:00:00.977939)
            --&gt;  76.2% finished (Elapsed time: 0:00:00.978536)
            --&gt;  81.0% finished (Elapsed time: 0:00:00.986795)
            --&gt;  85.7% finished (Elapsed time: 0:00:00.974766)
            --&gt;  90.5% finished (Elapsed time: 0:00:00.987233)
            --&gt;  95.2% finished (Elapsed time: 0:00:00.979331)
            --&gt; 100.0% finished (Elapsed time: 0:00:00.979152)
            Wait for other processes...
            --&gt; finished (Elapsed time: 0:00:00.000012)
            Gather results from other processes...
            --&gt; finished (Elapsed time: 0:00:00.009382)
    Report of the intra-atomic spin current accumulation
                 Site   A0_intra_eV   Ax_intra_eV   Ay_intra_eV   Az_intra_eV
         0.000000e+00  9.497611e-17 -1.439967e-27 -4.761170e-26  1.517883e-17
         1.000000e+00 -1.439532e-18  6.602011e-26  6.019083e-26  7.951522e-20
         2.000000e+00 -1.047351e-19 -9.094378e-26 -9.527625e-26 -1.004776e-20
         3.000000e+00  1.001354e-21  4.256611e-26  1.862764e-26  1.414944e-21
         4.000000e+00 -6.349936e-22  7.181482e-25 -6.966878e-25  7.961581e-22
         5.000000e+00  8.885729e-26  1.253659e-25  4.422670e-25 -2.430610e-23
         6.000000e+00  2.895082e-24 -2.007251e-24  7.347041e-24  2.056567e-24
         7.000000e+00  1.428565e-24  1.306155e-24 -1.526988e-24 -2.773661e-24
         8.000000e+00 -1.690550e-23  3.034477e-23  5.394769e-23  5.557620e-24
         9.000000e+00  1.137373e-24  8.575940e-24  7.837859e-23 -8.065011e-24
         1.000000e+01  2.773640e-23  1.062410e-22 -1.556909e-22  4.213451e-24
         1.100000e+01 -2.982051e-23 -8.116710e-24 -2.998530e-24 -3.317124e-23
         1.200000e+01 -1.257315e-22 -4.113156e-22  1.100977e-21  1.406207e-22
         1.300000e+01 -1.819797e-21 -5.012715e-22  7.385069e-21 -1.058791e-22
         1.400000e+01  3.388132e-21 -4.870439e-21  2.541099e-21 -3.811648e-21
         1.500000e+01 -3.176374e-21 -3.176374e-21  2.541109e-21  5.717472e-21
         1.600000e+01 -8.007108e-22  9.264423e-23  6.220462e-22 -1.968690e-22
         1.700000e+01 -1.159707e-21  1.579915e-22  1.049696e-21  9.802090e-22
         1.800000e+01 -2.305766e-23  2.838263e-23  3.207374e-22  1.000372e-23
         1.900000e+01 -5.893662e-24  5.014782e-24  1.912843e-22 -1.487633e-23
         2.000000e+01 -8.375204e-24  9.822770e-24  2.613797e-23 -2.985605e-23
         2.100000e+01  2.347125e-23  1.386820e-23 -2.245020e-23 -1.368725e-23
         2.200000e+01 -3.709250e-25 -8.239982e-25  5.641294e-25 -1.129269e-23
         2.300000e+01 -2.448624e-25  1.672612e-24 -4.979871e-24 -2.134205e-24
         2.400000e+01  8.229801e-24  8.211222e-25  2.421712e-24 -5.315009e-26
         2.500000e+01  2.583001e-23  3.915149e-22  1.730736e-24  7.056834e-25
         2.600000e+01  2.568913e-21  8.360211e-22  1.327838e-26 -2.261822e-26
         2.700000e+01  1.766072e-20 -1.159577e-19 -1.714033e-25  1.033319e-33
         2.800000e+01 -1.074885e-18  5.283368e-20  4.623434e-26 -9.309110e-34
         2.900000e+01 -8.326673e-17 -2.818926e-18 -1.234095e-26 -5.617810e-33
    Report of the inter-atomic spin current accumulation
                 Site   A0_inter_eV   Ax_inter_eV   Ay_inter_eV   Az_inter_eV
         0.000000e+00  3.309805e-02  2.391885e-10 -7.026460e-10  1.629750e-02
         1.000000e+00 -3.299830e-02 -2.836272e-09 -2.179475e-09 -1.671807e-02
         2.000000e+00 -3.247305e-05  4.118441e-09  9.829391e-09  4.697895e-04
         3.000000e+00  1.166710e-05  1.159065e-08  6.948219e-09  2.901698e-05
         4.000000e+00 -1.915138e-06 -3.516658e-08 -7.322370e-08 -1.246392e-06
         5.000000e+00 -2.031594e-07 -3.264152e-08  1.540051e-08 -1.772569e-07
         6.000000e+00  3.946354e-08  2.525382e-07  5.097357e-07  4.042459e-08
         7.000000e+00  1.102399e-09 -9.355308e-08 -6.991133e-07  1.133891e-09
         8.000000e+00 -1.557392e-09 -1.694422e-06 -3.231379e-06 -1.555806e-09
         9.000000e+00  3.826318e-10  2.215984e-06  6.009934e-06  3.682017e-10
         1.000000e+01 -6.498934e-11  5.445955e-06  1.254568e-05 -9.172633e-11
         1.100000e+01  2.660680e-12 -8.368109e-06 -2.281097e-05 -2.218487e-10
         1.200000e+01  2.040275e-12 -2.192596e-05 -5.769606e-05 -1.193908e-09
         1.300000e+01 -7.924081e-13  3.141844e-05  7.138241e-05 -4.728251e-09
         1.400000e+01  1.665564e-13  6.940915e-05  1.611806e-04 -2.494360e-07
         1.500000e+01  2.178072e-14  2.445917e-07 -1.560270e-04 -6.818500e-05
         1.600000e+01  8.634398e-13  6.256708e-09 -7.588276e-05 -3.145995e-05
         1.700000e+01 -9.883084e-12  1.165871e-09  5.219711e-05  1.951402e-05
         1.800000e+01  3.148942e-11  3.661123e-10  2.726874e-05  9.048806e-06
         1.900000e+01  6.480213e-11  1.037237e-10 -1.131641e-05 -4.704706e-06
         2.000000e+01 -8.159100e-10 -7.983134e-10 -6.642211e-06 -2.171086e-06
         2.100000e+01  2.471897e-09  2.470660e-09  2.656863e-06  1.306189e-06
         2.200000e+01  3.692503e-09  3.708007e-09  1.125140e-06  2.496813e-07
         2.300000e+01 -3.921867e-08 -3.855253e-08 -5.336990e-07 -2.256748e-07
         2.400000e+01  8.183146e-08  1.020493e-07 -6.952084e-08 -2.963342e-09
         2.500000e+01 -2.351105e-06 -1.795353e-06  8.784957e-08  3.642885e-08
         2.600000e+01  1.777699e-05  3.277303e-05 -1.797358e-10 -3.976661e-09
         2.700000e+01 -3.198684e-05  4.139673e-04 -1.383013e-08 -5.682770e-09
         2.800000e+01 -3.261158e-02 -1.800594e-02  1.570455e-09  1.319258e-09
         2.900000e+01  3.255123e-02  1.748407e-02  1.468057e-09  4.787358e-10
Calculation of spin current finished (2024-08-15 20:38:55)
Elapsed time----------------------------: 0:00:45.843087
</pre></div>
</div>
</div>
</details>
</div>
<p>Given that the central region consists of 30 atoms aligned along the $z$ axis, there are 29 interfaces. The <code class="docutils literal notranslate"><span class="pre">[calcr].interfacial_spin_current</span></code> function returns the electron current in units of eV. The spin currents, <code class="docutils literal notranslate"><span class="pre">Qx</span></code>, <code class="docutils literal notranslate"><span class="pre">Qy</span></code>, and <code class="docutils literal notranslate"><span class="pre">Qz</span></code>, correspond to the projections onto the Pauli matrices $\sigma_x$, $\sigma_y$, and $\sigma_z$, respectively. <code class="docutils literal notranslate"><span class="pre">Q0</span></code> represents the total current, obtained by summing the spin-up and spin-down components, which is equivalent to projecting onto $\sigma_0$.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># #interfaces = #sites - 1</span>
<span class="n">interfaces</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">29</span><span class="p">)</span>
<span class="c1"># shape: (#interfaces, #spin)</span>
<span class="n">isc</span> <span class="o">=</span> <span class="n">calcr_sc</span><span class="o">.</span><span class="n">interfacial_spin_current</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">interfaces</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="o">-</span><span class="mi">3</span><span class="p">],</span> <span class="n">isc</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mf">1e3</span><span class="p">,</span> <span class="s1">&#39;.-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Qx&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">interfaces</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="o">-</span><span class="mi">3</span><span class="p">],</span> <span class="n">isc</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="mf">1e3</span><span class="p">,</span> <span class="s1">&#39;.-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Qy&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">interfaces</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="o">-</span><span class="mi">3</span><span class="p">],</span> <span class="n">isc</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="mf">1e3</span><span class="p">,</span> <span class="s1">&#39;.-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Qz&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">interfaces</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="o">-</span><span class="mi">3</span><span class="p">],</span> <span class="n">isc</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mf">1e3</span><span class="p">,</span> <span class="s1">&#39;.-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Q0&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Interface (#)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Interfacial spin current (meV)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../../../../_images/541d372ed7c6109309f48bb23b0362c95241ea12d00185074cf3c3dba0b633a1.svg" src="../../../../../../_images/541d372ed7c6109309f48bb23b0362c95241ea12d00185074cf3c3dba0b633a1.svg" />
</div>
</div>
<p>We also convert the electron current to the charge current in units of amperes by multiplying by $-2e/\hbar$. Note that the almost constant value of charge (<code class="docutils literal notranslate"><span class="pre">I0=3.74e-8</span></code>) is close to the value calculated by <code class="docutils literal notranslate"><span class="pre">jp.Current</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">isc2</span> <span class="o">=</span> <span class="n">isc</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="n">jp</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">E2OVERHBAR</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">interfaces</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="o">-</span><span class="mi">3</span><span class="p">],</span> <span class="n">isc2</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;.-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Ix&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">interfaces</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="o">-</span><span class="mi">3</span><span class="p">],</span> <span class="n">isc2</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;.-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Iy&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">interfaces</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="o">-</span><span class="mi">3</span><span class="p">],</span> <span class="n">isc2</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="s1">&#39;.-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Iz&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">interfaces</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="o">-</span><span class="mi">3</span><span class="p">],</span> <span class="n">isc2</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;.-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;I0&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Interface (#)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Interfacial spin current (A)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../../../../_images/212663129aed7e670ebc39ba5b9f070c7a2802615db078eedcf1f9938c7d3e52.svg" src="../../../../../../_images/212663129aed7e670ebc39ba5b9f070c7a2802615db078eedcf1f9938c7d3e52.svg" />
</div>
</div>
<p>The gradient of the interfacial spin current should yield the results of spin accumulation. One can compare with the results from the <code class="docutils literal notranslate"><span class="pre">[calcr].spin_accumulation</span></code> calculation above.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># shape: (#sites-2, #spin)</span>
<span class="n">isca</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">isc</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sites</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="o">-</span><span class="mi">3</span><span class="p">],</span> <span class="n">isca</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mf">1e3</span><span class="p">,</span> <span class="s1">&#39;.-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;-$\nabla$Qx&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sites</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="o">-</span><span class="mi">3</span><span class="p">],</span> <span class="n">isca</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="mf">1e3</span><span class="p">,</span> <span class="s1">&#39;.-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;-$\nabla$Qy&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sites</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="o">-</span><span class="mi">3</span><span class="p">],</span> <span class="n">isca</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="mf">1e3</span><span class="p">,</span> <span class="s1">&#39;.-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;-$\nabla$Qz&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sites</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="o">-</span><span class="mi">3</span><span class="p">],</span> <span class="n">isca</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mf">1e3</span><span class="p">,</span> <span class="s1">&#39;.-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;-$\nabla$Q0&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Site (#)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Spin current accumulation (meV)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../../../../_images/4b1c744460b00402ac14b1493765f37da0db22636e167f4312b351b781a3640a.svg" src="../../../../../../_images/4b1c744460b00402ac14b1493765f37da0db22636e167f4312b351b781a3640a.svg" />
</div>
</div>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, tangtang.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>